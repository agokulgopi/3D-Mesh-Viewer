<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>3D Mesh Showcase</title>

  <style>
    :root {
      --ui-bg: rgba(51, 51, 51, 0.9);
      --ui-color: #fff;
      --thumb-size: 84px;
      --header-height: 70px;
    }

    html, body {
      margin: 0;
      height: 100%;
      background: #ffffff;
      font-family: Arial, sans-serif;
    }

    /* ---------------------------------------------------
       HEADER (BLACK, LOGO LEFT, ICONS RIGHT)
    --------------------------------------------------- */
    header {
      width: 100%;
      height: var(--header-height);
      background: #000;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 25px;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 2000;
    }

    #logo {
      height: 50px;
      width: auto;
    }

    /* Center Title in Header */
    #header-title {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      font-size: 22px;
      font-weight: bold;
      letter-spacing: 1px;
      color: #fff;

      /* Animation */
      opacity: 0;
      transform: translateX(-50%) translateY(10px);
      animation: titleFadeIn 1.2s ease-out forwards;
    }

    @keyframes titleFadeIn {
      0% { opacity: 0; transform: translateX(-50%) translateY(14px); }
      100% { opacity: 1; transform: translateX(-50%) translateY(0px); }
    }

    /* Icons Right */
    #header-icons {
      display: flex;
      gap: 18px;
      align-items: center;
      padding-right: 40px;
    }

    .header-icon {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      text-decoration: none;
      font-size: 18px;
      transition: 0.3s;
    }
    .header-icon:hover {
      background: #333;
      transform: scale(1.15);
      color: #44aaff;
      box-shadow: 0 0 10px #44aaff;
    }

    /* ---------------------------------------------------
       VIEWER AREA
    --------------------------------------------------- */
    #viewer {
      position: absolute;
      top: var(--header-height);
      bottom: 0;
      left: 0;
      width: 100%;
      overflow: hidden;
      background:#fff;
    }

    canvas { display:block; }

    /* UI PANEL */
    #uiPanel {
      position: absolute;
      top: 12px;
      right: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      z-index: 40;
    }

    .ui-btn {
      padding: 8px 10px;
      border: none;
      background: var(--ui-bg);
      color: var(--ui-color);
      border-radius: 5px;
      cursor: pointer;
    }

    /* LOADING SCREEN */
    #loadingScreen {
      position: fixed;
      top:0; left:0;
      width:100vw; height:100vh;
      background: rgba(255,255,255,0.95);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      z-index:3000;
      font-size:20px;
    }
    #progressBar { width:300px; height:12px; background:#ddd; border-radius:6px; overflow:hidden; margin-top:15px; }
    #progressFill { width:0%; height:100%; background:#44aaff; }

    /* THUMB STRIP */
    #thumbStrip {
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom: 40px;
      display:flex;
      gap:10px;
      padding:10px 14px;
      background:rgba(255,255,255,0.85);
      border-radius:14px;
      max-width:calc(100% - 30px);
      overflow-x:auto;
      -webkit-overflow-scrolling:touch;
      backdrop-filter:blur(6px);
      z-index:40;
    }
    .thumb { width: var(--thumb-size); min-width: var(--thumb-size); text-align:center; }
    .thumb img {
      width:100%;
      height:var(--thumb-size);
      object-fit: cover;
      border-radius:10px;
      border:2px solid transparent;
      box-shadow:0 4px 10px rgba(0,0,0,0.15);
    }
    .thumb.selected img { border-color:#44aaff; transform:scale(0.97); }

    @media(max-width:700px){
      :root { --thumb-size:64px; }
    }

    /* MOBILE SCROLL BUTTON */
    #mobileScrollBtn {
      position:absolute;
      right:20px;
      bottom:140px;
      z-index:60;
      background:#333;
      color:#fff;
      padding:12px;
      border-radius:50%;
      font-size:18px;
      display:none;
    }
    @media(max-width:700px){
      #mobileScrollBtn { display:block; }
    }

    /* ---------------------------------------------------
       MODEL INFO POPUP
    --------------------------------------------------- */
    #infoPopup {
      position: fixed;
      top:0; left:0;
      width:100vw; height:100vh;
      background: rgba(0,0,0,0.65);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:4000;
      backdrop-filter: blur(4px);
    }

    #infoContent {
      background: #fff;
      color: #222;
      padding: 24px 30px;
      width: 90%;
      max-width: 420px;
      border-radius: 14px;
      box-shadow: 0 6px 24px rgba(0,0,0,0.25);
      position: relative;
      animation: popupShow 0.35s ease-out;
    }

    #infoClose {
      position: absolute;
      right: 14px;
      top: 10px;
      font-size: 28px;
      cursor: pointer;
      color: #444;
      transition: 0.2s;
    }
    #infoClose:hover { color:#000; }

    #infoContent h2 { margin:0 0 10px; font-size:22px; color:#111; }

    @keyframes popupShow {
      0% { opacity:0; transform:scale(0.85); }
      100% { opacity:1; transform:scale(1); }
    }

  </style>

  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
</head>

<body>

<!-- HEADER -->
<header>
  <img id="logo" src="logo.png" alt="Logo">
  <div id="header-title">3D Model Showcase</div>

  <div id="header-icons">
    <a href="#" class="header-icon"><i class="fab fa-instagram"></i></a>
    <a href="#" class="header-icon"><i class="fab fa-facebook-f"></i></a>
    <a href="#" class="header-icon"><i class="fab fa-linkedin-in"></i></a>
    <a href="#" class="header-icon"><i class="fab fa-youtube"></i></a>
  </div>
</header>

<!-- LOADING -->
<div id="loadingScreen">
  <div>Loading Model...</div>
  <div id="progressBar"><div id="progressFill"></div></div>
</div>

<!-- MODEL INFO POPUP -->
<div id="infoPopup">
  <div id="infoContent">
    <span id="infoClose">×</span>
    <h2 id="infoTitle">Model Title</h2>
    <p id="infoDescription">Model description...</p>
    <div id="infoDetails"></div>
  </div>
</div>

<!-- VIEWER -->
<div id="viewer">

  <div id="uiPanel">
    <button class="ui-btn" id="infoBtn">Info</button>
    <button class="ui-btn" id="resetBtn">Reset</button>
    <button class="ui-btn" id="rotateBtn">Auto-Rotate: ON</button>
    <button class="ui-btn" id="zoomInBtn">Zoom +</button>
    <button class="ui-btn" id="zoomOutBtn">Zoom -</button>
    <button class="ui-btn" id="fullscreenBtn">Fullscreen</button>
  </div>

  <div id="thumbStrip"></div>
  <div id="mobileScrollBtn">↑</div>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- JS -->
<script type="module">
import * as THREE from "three";
import { OrbitControls } from "three/addons/controls/OrbitControls.js";
import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";
import { RGBELoader } from "three/addons/loaders/RGBELoader.js";

const loadingScreen = document.getElementById("loadingScreen");
const progressFill  = document.getElementById("progressFill");
const thumbStrip    = document.getElementById("thumbStrip");

/* MODEL INFO DATA */
const modelInfo = {
  "models/flowervase.glb": {
    title: "Flower Vase",
    description: "A beautifully detailed ceramic flower vase.",
    details: `
      <strong>Category:</strong> Home Decor<br>
      <strong>Material:</strong> Ceramic<br>
      <strong>Dimensions:</strong> 20cm x 10cm x 10cm
    `
  },
  "models/mobile_phone.glb": {
    title: "Smartphone",
    description: "High-poly smartphone model with realistic textures.",
    details: `
      <strong>Category:</strong> Electronics<br>
      <strong>Material:</strong> Glass + Aluminum<br>
      <strong>Size:</strong> 14cm x 7cm
    `
  },
  "models/street_stall.glb": {
    title: "Street Food Stall",
    description: "A detailed street food stall with accessories.",
    details: `
      <strong>Category:</strong> Market Stall<br>
      <strong>Material:</strong> Wood + Steel
    `
  },
  "models/stall.glb": {
    title: "Market Stall",
    description: "Classic marketplace stall structure.",
    details: `
      <strong>Category:</strong> Retail<br>
      <strong>Material:</strong> Wood
    `
  }
};

/* SCENE */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xffffff);

const viewer = document.getElementById("viewer");
const camera = new THREE.PerspectiveCamera(60, viewer.clientWidth/viewer.clientHeight, 0.1, 1000);

/* CLOSER DEFAULT CAMERA */
camera.position.set(1.6, 1.8, 2.0);

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(viewer.clientWidth, viewer.clientHeight);
renderer.shadowMap.enabled = true;
viewer.appendChild(renderer.domElement);

/* CONTROLS */
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

/* LIGHTS */
scene.add(new THREE.AmbientLight(0xffffff,0.55));
const d = new THREE.DirectionalLight(0xffffff,1.2);
d.position.set(4,8,6);
d.castShadow = true;
scene.add(d);

/* HDRI */
new RGBELoader().load(
  "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/studio_small_08_1k.hdr",
  hdr=>{
    hdr.mapping = THREE.EquirectangularReflectionMapping;
    scene.environment = hdr;
  }
);

/* GROUND */
const ground = new THREE.Mesh(
  new THREE.PlaneGeometry(40,40),
  new THREE.ShadowMaterial({ opacity:0.18 })
);
ground.rotation.x = -Math.PI/2;
scene.add(ground);

/* MODEL LOADER */
const loader = new GLTFLoader();
let currentModel = null;
let autoRotate = true;
let currentModelPath = null;

function fitModelToView(obj){
  const box = new THREE.Box3().setFromObject(obj);
  const size = new THREE.Vector3();
  const center = new THREE.Vector3();
  box.getCenter(center);
  box.getSize(size);
  obj.position.sub(center);

  const maxDim = Math.max(size.x, size.y, size.z);
  const distance = maxDim * 0.95;
  camera.position.set(distance, distance * 1.1, distance);
}

function loadModel(path, mark=true){
  if(currentModel) scene.remove(currentModel);

  loadingScreen.style.display="flex";
  progressFill.style.width="0%";
  currentModelPath = path;

  loader.load(
    path,
    gltf=>{
      currentModel = gltf.scene;
      currentModel.traverse(o=>{ if(o.isMesh) o.castShadow = true; });
      fitModelToView(currentModel);
      scene.add(currentModel);

      loadingScreen.style.display="none";
      if(mark) selectThumb(path);
    },
    xhr=> progressFill.style.width = (xhr.loaded/xhr.total)*100 + "%"
  );
}

/* BUTTONS */
infoBtn.onclick = () => {
  const popup = document.getElementById("infoPopup");

  if(currentModelPath && modelInfo[currentModelPath]) {
    infoTitle.textContent = modelInfo[currentModelPath].title;
    infoDescription.textContent = modelInfo[currentModelPath].description;
    infoDetails.innerHTML = modelInfo[currentModelPath].details;
  }

  popup.style.display = "flex";
};

infoClose.onclick = () => {
  document.getElementById("infoPopup").style.display = "none";
};

document.getElementById("infoPopup").onclick = (e) => {
  if(e.target.id === "infoPopup") e.target.style.display = "none";
};

resetBtn.onclick = ()=>{
  camera.position.set(1.6, 1.8, 2.0);
  controls.target.set(0,0,0);
};

rotateBtn.onclick = e=>{
  autoRotate = !autoRotate;
  e.target.innerText = "Auto-Rotate: " + (autoRotate ? "ON" : "OFF");
};

zoomInBtn.onclick=()=> zoomBy(1.2);
zoomOutBtn.onclick=()=> zoomBy(0.8);

function zoomBy(f){
  const dir = new THREE.Vector3().subVectors(camera.position, controls.target);
  dir.multiplyScalar(1/f);
  camera.position.copy(controls.target).add(dir);
}

fullscreenBtn.onclick=()=>{
  if(!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
};

/* THUMBNAILS */
const models = [
  { model:"models/flowervase.glb", thumb:"thumbnails/flower.jpg", label:"Vase" },
  { model:"models/mobile_phone.glb", thumb:"thumbnails/phone.jpg", label:"Phone" },
  { model:"models/street_stall.glb", thumb:"thumbnails/food.jpg", label:"Stall" },
  { model:"models/stall.glb",       thumb:"thumbnails/food.jpg", label:"Stall 2" }
];

models.forEach(item=>{
  const wrap = document.createElement("div");
  wrap.className="thumb";
  wrap.dataset.model=item.model;

  wrap.innerHTML=`
    <img src="${item.thumb}">
    <div class="label">${item.label}</div>
  `;

  wrap.onclick=()=> loadModel(item.model,true);
  thumbStrip.appendChild(wrap);
});

function selectThumb(path){
  document.querySelectorAll(".thumb").forEach(t=>{
    t.classList.toggle("selected", t.dataset.model===path);
  });
}

selectThumb(models[0].model);
loadModel(models[0].model);

/* MOBILE SCROLL BUTTON */
const scrollBtn = document.getElementById("mobileScrollBtn");
let raised=false;

scrollBtn.onclick=()=>{
  if(!raised){
    thumbStrip.style.bottom="130px";
    scrollBtn.innerHTML="↓";
    raised=true;
  } else {
    thumbStrip.style.bottom="40px";
    scrollBtn.innerHTML="↑";
    raised=false;
  }
};

/* ANIMATE */
function animate(){
  requestAnimationFrame(animate);
  if(currentModel && autoRotate) currentModel.rotation.y += 0.003;
  controls.update();
  renderer.render(scene,camera);
}
animate();

/* RESIZE */
addEventListener("resize",()=>{
  renderer.setSize(viewer.clientWidth, viewer.clientHeight);
  camera.aspect = viewer.clientWidth/viewer.clientHeight;
  camera.updateProjectionMatrix();
});
</script>

</body>
</html>
